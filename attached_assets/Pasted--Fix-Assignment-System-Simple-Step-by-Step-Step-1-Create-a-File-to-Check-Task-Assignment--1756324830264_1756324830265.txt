# Fix Assignment System - Simple Step by Step

## Step 1: Create a File to Check Task Assignment

Create a new file: `src/utils/taskHelpers.js`

Put this code in it:
```javascript
export function isMyTask(task, currentUser) {
  if (!task) return false;
  if (!currentUser) return false;
  if (!task.assignTo) return false;
  
  // Check if task is assigned to me directly
  if (task.assignTo === `user_${currentUser.id}`) {
    return true;
  }
  
  // Check if task is assigned to all staff
  if (task.assignTo === 'all_staff') {
    return true;
  }
  
  // Check if task is assigned to my role
  if (task.assignTo.startsWith('role_')) {
    const taskRole = task.assignTo.replace('role_', '');
    if (currentUser.rolesAssigned && currentUser.rolesAssigned.includes(taskRole)) {
      return true;
    }
  }
  
  return false;
}
```

## Step 2: Import This Function in TaskCard

Open your TaskCard component file.

At the top, add this import:
```javascript
import { isMyTask } from '../utils/taskHelpers';
```

## Step 3: Use the Function in TaskCard

Find where TaskCard is defined. Replace the whole component with:

```javascript
const TaskCard = ({ task, currentUser, staff }) => {
  const assignedToMe = isMyTask(task, currentUser);
  
  return (
    <div className={`task-card ${assignedToMe ? 'assigned-to-me' : ''}`}>
      <div className="task-badges-row">
        <div className="left-badges">
          <span className="day-badge">THU</span>
          <span className={`priority-badge ${task.priority.toLowerCase()}`}>
            {task.priority}
          </span>
        </div>
        {assignedToMe && (
          <div className="right-badges">
            <span className="your-task-badge">ğŸ“Œ Your Task</span>
          </div>
        )}
      </div>
      
      <div className="task-content">
        <h3>{task.title}</h3>
        <p className="task-type">{task.taskType}</p>
      </div>
      
      <button className="start-task-btn">Start Task</button>
    </div>
  );
};
```

## Step 4: Add CSS for Green Border

Find your CSS file for tasks.

Add these styles:
```css
.task-card.assigned-to-me {
  border-left: 4px solid #2D8028;
}

.your-task-badge {
  background: #2D8028;
  color: white;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}

.task-badges-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 12px;
}

.right-badges {
  display: flex;
  gap: 4px;
}
```

## Step 5: Fix the Filter in TasksPage

Find your TasksPage component.

Import the helper function at the top:
```javascript
import { isMyTask } from '../utils/taskHelpers';
```

Find where you filter tasks. Replace your filter function with:
```javascript
const getFilteredTasks = () => {
  const today = new Date().toISOString().split('T')[0];
  
  return tasks.filter(task => {
    // Date filter
    if (task.status === 'completed' || task.status === 'skipped') {
      const actionDate = (task.completedAt || task.skippedAt || task.dueDate).split('T')[0];
      if (actionDate !== filters.date) return false;
    } else {
      const isOverdue = task.dueDate < today && task.status === 'pending';
      if (isOverdue && filters.date === today) {
        // Show overdue on today
      } else if (task.dueDate !== filters.date) {
        return false;
      }
    }
    
    // Category filter
    if (filters.category !== 'All') {
      if (task.taskType !== filters.category) return false;
    }
    
    // Status filter
    if (filters.status !== 'All') {
      if (task.status !== filters.status) return false;
    }
    
    // Priority filter
    if (filters.priority !== 'All') {
      if (task.priority !== filters.priority) return false;
    }
    
    // Only My Tasks filter
    if (filters.assignedToMe === true) {
      if (!isMyTask(task, currentUser)) return false;
    }
    
    // Search filter
    if (filters.searchQuery !== '') {
      const query = filters.searchQuery.toLowerCase();
      const inTitle = task.title.toLowerCase().includes(query);
      const inDescription = task.description && task.description.toLowerCase().includes(query);
      if (!inTitle && !inDescription) return false;
    }
    
    return true;
  });
};
```

## Step 6: Make Sure TaskCard Gets Current User

Find where you render TaskCard components in TasksPage.

Make sure it looks like this:
```javascript
{filteredTasks.map(task => (
  <TaskCard 
    key={task.id} 
    task={task}
    currentUser={currentUser}
    staff={staff}
  />
))}
```

## Step 7: Change Filter Label

Find where your filter toggle is rendered.

Change the label from:
```javascript
<span className="toggle-label">ğŸ“Œ Assigned to Me</span>
```

To:
```javascript
<span className="toggle-label">ğŸ“Œ Only My Tasks</span>
```

## That's It!

Now:
- Every task shows a green border if it's yours
- Every task shows "ğŸ“Œ Your Task" badge if it's yours
- The filter hides tasks that aren't yours
- All filters work together

No debugging. No temporary code. Just these 7 steps.