# Replit Instructions: Add Quarterly Tasks (Clean Implementation)

**IMPORTANT: Do not delete any existing tasks, recurring tasks, or user data. Only update the code functionality while preserving all existing data.**

## Step 1: Add Quarterly to Frequency Options

Find where task frequencies are defined and add 'quarterly':

```javascript
// In the recurring task frequency options
const frequencyOptions = [
  { value: 'daily', label: 'Weekly' },
  { value: 'biweekly', label: 'Bi-Weekly' },
  { value: 'monthly', label: 'Monthly' },
  { value: 'quarterly', label: 'Quarterly' } // ADD THIS
];
```

## Step 2: Update Frequency-Specific Logic

In the `getTasksForFrequency` function, add the quarterly case:

```javascript
case 'quarterly':
  // Generate on first day of quarter, due on last day of quarter
  const quarterStartMonths = [0, 3, 6, 9]; // Jan, Apr, Jul, Oct
  if (quarterStartMonths.includes(month) && dayOfMonth === 1) {
    const quarterEndMonth = month + 2;
    const lastDayOfQuarter = new Date(year, quarterEndMonth + 1, 0);
    
    tasks.push({
      visibleFrom: new Date(year, month, 1),
      dueDate: lastDayOfQuarter,
      periodLabel: `Q${Math.floor(month / 3) + 1}`
    });
  }
  break;
```

## Step 3: Update Recurring Task Editor UI

Add quarterly option preview in the recurring task editor:

```javascript
// In the getFrequencyPreview function
case 'quarterly':
  return `Task will appear on the first day of each quarter (Jan 1, Apr 1, Jul 1, Oct 1) and be due on the last day of the quarter`;
```

## Step 4: Ensure Ordinal Suffix Function Exists

Make sure this helper function is available (if not already):

```javascript
const getOrdinalSuffix = (day) => {
  const j = day % 10;
  const k = day % 100;
  if (j === 1 && k !== 11) return 'st';
  if (j === 2 && k !== 12) return 'nd';
  if (j === 3 && k !== 13) return 'rd';
  return 'th';
};
```

## How Quarterly Tasks Work

1. **Generation Schedule:**
   - Tasks generate on: January 1, April 1, July 1, October 1
   - Tasks are visible immediately from generation date
   - Each task covers a full quarter (3 months)

2. **Due Dates:**
   - Q1: Due March 31
   - Q2: Due June 30
   - Q3: Due September 30
   - Q4: Due December 31

3. **Period Labels:**
   - Tasks display their quarter: "Q1", "Q2", "Q3", "Q4"
   - This helps users identify which quarter the task covers

## Integration Notes

- Quarterly tasks follow the same pattern as monthly and bi-weekly tasks
- They use the `visibleFromDate` and `dueDate` fields
- Tasks are generated and stored in the database on the first day of each quarter
- The existing task generation service will handle quarterly tasks automatically