# Replit Instructions: Fix Broken Task Status Updates

**CRITICAL: Make ONLY permanent fixes. NO temporary code, NO debug logs, NO test buttons.**

## Step 1: Find and Fix the Task Status Update Functions

Locate these functions and replace them completely:

```javascript
const updateTaskStatus = (taskId, newStatus) => {
  setTasks(prevTasks => {
    const updatedTasks = prevTasks.map(task => {
      if (task.id === taskId || task.id.toString() === taskId.toString()) {
        const updatedTask = {
          ...task,
          status: newStatus,
          ...(newStatus === 'in-progress' && { startedAt: new Date().toISOString() }),
          ...(newStatus === 'completed' && { completedAt: new Date().toISOString() })
        };
        
        // Save immediately
        saveTask(updatedTask);
        return updatedTask;
      }
      return task;
    });
    
    return updatedTasks;
  });
};

const handleStartTask = (taskId) => {
  updateTaskStatus(taskId, 'in-progress');
};

const handleCompleteTask = (taskId) => {
  updateTaskStatus(taskId, 'completed');
};
```

## Step 2: Fix Task Card Button Handlers

In the TaskCard component, ensure buttons are wired correctly:

```javascript
// For pending tasks
{task.status === 'pending' && (
  <button 
    onClick={() => onStartTask(task.id)}
    className="btn-start"
  >
    Start Task
  </button>
)}

// For in-progress tasks
{task.status === 'in-progress' && (
  <button 
    onClick={() => onCompleteTask(task.id)}
    className="btn-complete"
  >
    Mark Complete
  </button>
)}

// For completed tasks
{task.status === 'completed' && (
  <span className="status-completed">âœ“ Completed</span>
)}
```

## Step 3: Ensure Props Are Passed Correctly

When rendering TaskCard components:

```javascript
<TaskCard 
  key={task.id}
  task={task} 
  onStartTask={handleStartTask}
  onCompleteTask={handleCompleteTask}
/>
```

## Step 4: Fix Any ID Type Issues

In the update function, handle both string and number IDs:

```javascript
// This is already in Step 1, but ensure it's there:
if (task.id === taskId || task.id.toString() === taskId.toString()) {
```

## Step 5: Remove Any Disabled Logic on Buttons

Make sure buttons don't have complex disabled conditions:

```javascript
// Remove any disabled={...} attributes that might be blocking clicks
<button onClick={() => onStartTask(task.id)}>
  Start Task
</button>
```

## That's It

These permanent changes should fix the status update functionality. The key fixes are:
1. Using functional setState for reliable updates
2. Handling ID type mismatches
3. Saving immediately after updating
4. Ensuring props are connected properly
5. No complex disabled states

NO temporary code. NO debug statements. Just clean, working functionality.