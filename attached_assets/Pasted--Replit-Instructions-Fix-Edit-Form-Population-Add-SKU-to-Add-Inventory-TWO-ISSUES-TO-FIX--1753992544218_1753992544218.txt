# Replit Instructions: Fix Edit Form Population & Add SKU to Add Inventory

**TWO ISSUES TO FIX:**
1. Edit Inventory form not pre-populating with existing data
2. Add to Inventory form missing SKU field

## Issue 1: Fix Edit Form Not Populating

### Find where the edit modal is opened and check what's being passed:

```tsx
// The problem is the form is showing placeholder text instead of actual values
// Look for where setEditItem or openEditModal is called

const handleEdit = (item) => {
  console.log('Item being edited:', item); // ADD THIS to see the data
  setEditItem(item); // Make sure the full item is being set
  setShowEditModal(true);
};
```

### In the Edit Modal Component, check the props:

```tsx
const EditInventoryModal = ({ item, isOpen, onClose, onSave }) => {
  // ADD THIS to debug
  console.log('Edit modal received item:', item);
  
  // The form fields should use item values, not placeholder text
  const [formData, setFormData] = useState({
    name: '', // This is the problem - it's not using item data
    sku: '',
    currentStock: 0,
    // ... etc
  });

  // FIX: Initialize with item data when modal opens
  useEffect(() => {
    if (item && isOpen) {
      setFormData({
        name: item.name || '',
        sku: item.sku || '',
        currentStock: item.quantity || item.currentStock || 0,
        unit: item.unit || '',
        minimumStock: item.minimumStock || 0,
        category: item.category || 'Other Supplies',
        supplier: item.supplier || '',
        // ... all other fields
      });
    }
  }, [item, isOpen]);

  return (
    <div className="modal">
      <input
        type="text"
        value={formData.name} // Use formData.name, not placeholder
        onChange={(e) => setFormData({...formData, name: e.target.value})}
        placeholder="e.g., Arugula Seeds" // This should be placeholder, not value
      />
      {/* ... rest of form ... */}
    </div>
  );
};
```

### Alternative Fix - Direct Value Binding:

```tsx
// If the form uses item directly without local state
<input
  type="text"
  value={item?.name || ''} // Directly use item.name
  onChange={(e) => updateItem({...item, name: e.target.value})}
  placeholder="e.g., Arugula Seeds"
/>

<input
  type="text"
  value={item?.sku || ''} // Directly use item.sku
  onChange={(e) => updateItem({...item, sku: e.target.value.toUpperCase().slice(0, 4)})}
  placeholder="ARUG"
  maxLength={4}
/>
```

## Issue 2: Add SKU Field to Add Inventory Form

### In the Add to Inventory modal, add SKU field after the item selection:

```tsx
const AddInventoryModal = ({ isOpen, onClose, onAdd }) => {
  const [formData, setFormData] = useState({
    itemType: '',
    name: '',
    sku: '', // Add SKU to form state
    quantity: '',
    totalCost: '',
    notes: ''
  });

  return (
    <div className="modal">
      <h3>Add to Inventory</h3>
      
      {/* After Select Item dropdown */}
      <div className="form-group">
        <label>Select Item *</label>
        <select 
          value={formData.itemType}
          onChange={(e) => setFormData({...formData, itemType: e.target.value})}
        >
          <option value="">Select...</option>
          {/* ... options ... */}
        </select>
      </div>

      {/* ADD THIS: SKU field for new items */}
      {formData.itemType === 'new' && (
        <>
          <div className="form-group">
            <label>Item Name *</label>
            <input
              type="text"
              value={formData.name}
              onChange={(e) => setFormData({...formData, name: e.target.value})}
              placeholder="e.g., Spinach Seeds"
              required
            />
          </div>

          <div className="form-group">
            <label>SKU (4 characters max) *</label>
            <input
              type="text"
              value={formData.sku}
              onChange={(e) => setFormData({...formData, sku: e.target.value.toUpperCase().slice(0, 4)})}
              placeholder="SPIN"
              maxLength={4}
              required
            />
            <small>4-character code for tray IDs</small>
          </div>
        </>
      )}

      <div className="form-group">
        <label>Quantity to Add *</label>
        <input
          type="number"
          value={formData.quantity}
          onChange={(e) => setFormData({...formData, quantity: e.target.value})}
          placeholder="e.g., 50"
        />
      </div>

      {/* ... rest of form ... */}
      
      <button onClick={() => {
        // Include SKU when saving
        const newItem = {
          name: formData.name,
          sku: formData.sku,
          quantity: parseFloat(formData.quantity),
          totalCost: parseFloat(formData.totalCost),
          costPerUnit: parseFloat(formData.totalCost) / parseFloat(formData.quantity),
          category: 'Seeds', // or from form
          unit: 'oz', // or from form
          // ... other fields
        };
        onAdd(newItem);
      }}>
        Add to Inventory
      </button>
    </div>
  );
};
```

### If Add to Inventory only adds to existing items:

If the "Add to Inventory" is only for adding quantity to existing items (not creating new items), then update it to show the SKU of the selected item:

```tsx
<div className="form-group">
  <label>Select Item *</label>
  <select 
    value={selectedItemId}
    onChange={(e) => {
      const item = inventoryItems.find(i => i.id === e.target.value);
      setSelectedItem(item);
      setSelectedItemId(e.target.value);
    }}
  >
    <option value="">Select...</option>
    {inventoryItems.map(item => (
      <option key={item.id} value={item.id}>
        [{item.sku}] {item.name}
      </option>
    ))}
  </select>
</div>

{selectedItem && (
  <div className="item-details">
    <p>SKU: {selectedItem.sku}</p>
    <p>Current Stock: {selectedItem.quantity} {selectedItem.unit}</p>
  </div>
)}
```

## Debugging Steps:

1. **Check console for errors** when opening edit modal
2. **Log the item data** being passed to modals
3. **Verify field names match** between inventory items and form fields
4. **Check if modals are receiving props** correctly

The main issue is likely that the Edit form is not properly initializing its state with the item data when it opens.