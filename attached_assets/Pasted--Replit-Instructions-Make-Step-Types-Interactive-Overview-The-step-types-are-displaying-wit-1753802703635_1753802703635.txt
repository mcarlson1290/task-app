# Replit Instructions: Make Step Types Interactive

## Overview
The step types are displaying with correct icons but need to be made interactive so users can actually input data, not just view them.

## Step 1: Update Step Item Structure
Each step needs to track its completion state AND its data:

```javascript
// Example step structure
{
  id: 1,
  type: 'number_input',
  text: 'How many trays did you water?',
  completed: false,
  value: null, // Store the actual input
  required: true
}
```

## Step 2: Make Number Input Interactive
Replace the static number display with an actual input field:

```javascript
const NumberInputStep = ({ step, onUpdate }) => {
  const [value, setValue] = useState(step.value || '');
  
  const handleChange = (e) => {
    const newValue = e.target.value;
    setValue(newValue);
    onUpdate(step.id, { 
      value: newValue,
      completed: newValue !== '' // Mark complete when value entered
    });
  };
  
  return (
    <div className={`step-item number-input ${step.completed ? 'completed' : ''}`}>
      <span className="step-icon">üìä</span>
      <span className="step-text">{step.text}</span>
      <input
        type="number"
        value={value}
        onChange={handleChange}
        placeholder="Enter number..."
        className="number-field"
      />
    </div>
  );
};
```

## Step 3: Make Percentage/Estimate Input Interactive
For percentage questions like "What percent would you estimate had mold":

```javascript
const PercentageInputStep = ({ step, onUpdate }) => {
  const [value, setValue] = useState(step.value || '');
  
  const handleChange = (e) => {
    let newValue = e.target.value;
    // Ensure value is between 0-100
    if (newValue > 100) newValue = 100;
    if (newValue < 0) newValue = 0;
    
    setValue(newValue);
    onUpdate(step.id, { 
      value: newValue,
      completed: newValue !== ''
    });
  };
  
  return (
    <div className={`step-item percentage-input ${step.completed ? 'completed' : ''}`}>
      <span className="step-icon">üìä</span>
      <span className="step-text">{step.text}</span>
      <div className="input-group">
        <input
          type="number"
          min="0"
          max="100"
          value={value}
          onChange={handleChange}
          placeholder="0"
          className="percent-field"
        />
        <span className="percent-symbol">%</span>
      </div>
    </div>
  );
};
```

## Step 4: Make Photo Upload Functional
Enable actual photo capture/upload:

```javascript
const PhotoUploadStep = ({ step, onUpdate }) => {
  const [photo, setPhoto] = useState(step.photo || null);
  const [preview, setPreview] = useState(step.photoUrl || null);
  
  const handlePhotoChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      // Create preview
      const reader = new FileReader();
      reader.onloadend = () => {
        setPreview(reader.result);
      };
      reader.readAsDataURL(file);
      
      // Update step
      setPhoto(file);
      onUpdate(step.id, { 
        photo: file,
        photoUrl: URL.createObjectURL(file),
        completed: true
      });
    }
  };
  
  return (
    <div className={`step-item photo-upload ${step.completed ? 'completed' : ''}`}>
      <span className="step-icon">üì∑</span>
      <span className="step-text">{step.text}</span>
      <div className="photo-controls">
        <input
          type="file"
          accept="image/*"
          capture="environment" // Use camera on mobile
          onChange={handlePhotoChange}
          id={`photo-${step.id}`}
          style={{ display: 'none' }}
        />
        <label htmlFor={`photo-${step.id}`} className="photo-button">
          {preview ? 'Retake Photo' : 'Take Photo'}
        </label>
        {preview && (
          <img src={preview} alt="Captured" className="photo-preview" />
        )}
      </div>
    </div>
  );
};
```

## Step 5: Make Movement/Action Buttons Functional
For action items like "Move to the ebb and flow":

```javascript
const ActionStep = ({ step, onUpdate }) => {
  const [completed, setCompleted] = useState(step.completed || false);
  const [timestamp, setTimestamp] = useState(step.timestamp || null);
  
  const handleAction = () => {
    const now = new Date();
    setCompleted(true);
    setTimestamp(now);
    onUpdate(step.id, { 
      completed: true,
      timestamp: now.toISOString()
    });
  };
  
  return (
    <div className={`step-item action-step ${completed ? 'completed' : ''}`}>
      <span className="step-icon">‚û°Ô∏è</span>
      <span className="step-text">{step.text}</span>
      {!completed ? (
        <button onClick={handleAction} className="action-button">
          Mark Complete
        </button>
      ) : (
        <span className="completion-time">
          ‚úì Completed at {new Date(timestamp).toLocaleTimeString()}
        </span>
      )}
    </div>
  );
};
```

## Step 6: Create Tray Creation Step
For "Plant a new tray" type actions:

```javascript
const TrayCreationStep = ({ step, onUpdate }) => {
  const [showForm, setShowForm] = useState(false);
  const [trayData, setTrayData] = useState(step.trayData || {});
  
  const handleSaveTray = () => {
    onUpdate(step.id, { 
      completed: true,
      trayData: trayData
    });
    setShowForm(false);
  };
  
  return (
    <div className={`step-item tray-creation ${step.completed ? 'completed' : ''}`}>
      <span className="step-icon">üå±</span>
      <span className="step-text">{step.text}</span>
      {!step.completed ? (
        <button onClick={() => setShowForm(true)} className="create-button">
          Create Tray
        </button>
      ) : (
        <span className="tray-info">
          ‚úì Tray {trayData.id} created
        </span>
      )}
      
      {showForm && (
        <div className="tray-form-modal">
          <h4>New Tray Details</h4>
          <input
            type="text"
            placeholder="Tray ID"
            value={trayData.id || ''}
            onChange={(e) => setTrayData({...trayData, id: e.target.value})}
          />
          <select
            value={trayData.crop || ''}
            onChange={(e) => setTrayData({...trayData, crop: e.target.value})}
          >
            <option value="">Select crop...</option>
            <option value="romaine">Romaine</option>
            <option value="buttercrunch">Buttercrunch</option>
            <option value="arugula">Arugula</option>
          </select>
          <button onClick={handleSaveTray}>Save Tray</button>
          <button onClick={() => setShowForm(false)}>Cancel</button>
        </div>
      )}
    </div>
  );
};
```

## Step 7: Update Main Checklist Renderer
Update the renderer to handle all interactive types:

```javascript
const ChecklistStepRenderer = ({ step, onUpdate }) => {
  // Determine step type based on content/icons
  if (step.text.includes('How many')) {
    return <NumberInputStep step={step} onUpdate={onUpdate} />;
  }
  if (step.text.includes('percent')) {
    return <PercentageInputStep step={step} onUpdate={onUpdate} />;
  }
  if (step.text.includes('photo')) {
    return <PhotoUploadStep step={step} onUpdate={onUpdate} />;
  }
  if (step.text.includes('Move') || step.text.includes('ebb and flow')) {
    return <ActionStep step={step} onUpdate={onUpdate} />;
  }
  if (step.text.includes('Plant a new')) {
    return <TrayCreationStep step={step} onUpdate={onUpdate} />;
  }
  
  // Default to checkbox
  return <CheckboxStep step={step} onUpdate={onUpdate} />;
};
```

## Step 8: Add Progress Tracking
Show overall task completion based on required steps:

```javascript
const TaskProgress = ({ steps }) => {
  const totalSteps = steps.length;
  const completedSteps = steps.filter(s => s.completed).length;
  const percentage = (completedSteps / totalSteps) * 100;
  
  return (
    <div className="task-progress">
      <div className="progress-bar">
        <div 
          className="progress-fill" 
          style={{ width: `${percentage}%` }}
        />
      </div>
      <span className="progress-text">
        Step {completedSteps} of {totalSteps}
      </span>
    </div>
  );
};
```

## Step 9: Save Step Data
When task is completed, save all the collected data:

```javascript
const completeTask = async () => {
  const taskData = {
    taskId: task.id,
    completedAt: new Date(),
    stepData: steps.map(step => ({
      id: step.id,
      type: step.type,
      text: step.text,
      completed: step.completed,
      value: step.value,
      photo: step.photoUrl,
      timestamp: step.timestamp,
      trayData: step.trayData
    }))
  };
  
  await saveTaskCompletion(taskData);
};
```

## Step 10: Add Styling
```css
.step-item {
  display: flex;
  align-items: center;
  padding: 12px;
  margin: 8px 0;
  gap: 12px;
}

.step-item.completed {
  background: #e8f5e9;
}

.number-field, .percent-field {
  width: 80px;
  padding: 6px;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.photo-button {
  background: #2196F3;
  color: white;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
}

.photo-preview {
  max-width: 100px;
  max-height: 100px;
  margin-left: 10px;
}

.action-button {
  background: #4CAF50;
  color: white;
  padding: 6px 16px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
```

This will make each step type fully interactive, allowing users to input data that can be saved and analyzed later in your task data page.