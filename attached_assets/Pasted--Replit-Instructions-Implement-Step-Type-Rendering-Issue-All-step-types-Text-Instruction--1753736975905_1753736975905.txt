# Replit Instructions: Implement Step Type Rendering

## Issue
All step types (Text Instruction, Number Input, Inventory Selection, etc.) are rendering as checkboxes regardless of which type was selected.

## Step 1: Update Data Structure
First, ensure each checklist item stores its type:

```javascript
// When adding a step, include the type
const addChecklistStep = (stepType, stepData) => {
  const newStep = {
    id: Date.now(),
    type: stepType, // 'text_instruction', 'number_input', 'inventory_selection', etc.
    data: stepData,
    completed: false
  };
  
  setChecklistItems([...checklistItems, newStep]);
};
```

## Step 2: Create Step Type Components
Create a component for each step type:

```javascript
// Text Instruction - Just displays text, no interaction
const TextInstructionStep = ({ step, onUpdate }) => {
  return (
    <div className="step-item text-instruction">
      <span className="step-icon">ðŸ“„</span>
      <p className="instruction-text">{step.data.text}</p>
    </div>
  );
};

// Simple Checkbox - Standard checkbox
const SimpleCheckboxStep = ({ step, onUpdate }) => {
  return (
    <div className="step-item simple-checkbox">
      <input
        type="checkbox"
        checked={step.completed}
        onChange={(e) => onUpdate(step.id, { completed: e.target.checked })}
      />
      <label>{step.data.text}</label>
    </div>
  );
};

// Number Input - Requires numeric entry
const NumberInputStep = ({ step, onUpdate }) => {
  const [value, setValue] = useState(step.data.value || '');
  
  return (
    <div className="step-item number-input">
      <span className="step-label">{step.data.text}</span>
      <input
        type="number"
        value={value}
        onChange={(e) => {
          setValue(e.target.value);
          onUpdate(step.id, { value: e.target.value });
        }}
        placeholder={step.data.placeholder || 'Enter number...'}
      />
      {step.data.unit && <span className="unit">{step.data.unit}</span>}
    </div>
  );
};

// Inventory Selection - Dropdown of inventory items
const InventorySelectionStep = ({ step, onUpdate }) => {
  const [selectedItem, setSelectedItem] = useState(step.data.selectedItem || '');
  
  return (
    <div className="step-item inventory-selection">
      <span className="step-label">{step.data.text}</span>
      <select
        value={selectedItem}
        onChange={(e) => {
          setSelectedItem(e.target.value);
          onUpdate(step.id, { selectedItem: e.target.value });
        }}
      >
        <option value="">Select item...</option>
        <option value="rockwool">Rockwool Cubes</option>
        <option value="seeds-romaine">Seeds - Romaine</option>
        <option value="seeds-basil">Seeds - Basil</option>
        <option value="nutrients-a">Nutrients - Part A</option>
        <option value="nutrients-b">Nutrients - Part B</option>
      </select>
    </div>
  );
};

// System Assignment - Assign to growing system
const SystemAssignmentStep = ({ step, onUpdate }) => {
  const [system, setSystem] = useState(step.data.system || '');
  
  return (
    <div className="step-item system-assignment">
      <span className="step-label">{step.data.text}</span>
      <select
        value={system}
        onChange={(e) => {
          setSystem(e.target.value);
          onUpdate(step.id, { system: e.target.value });
        }}
      >
        <option value="">Select system...</option>
        <option value="nft-1">NFT Channel 1</option>
        <option value="nft-2">NFT Channel 2</option>
        <option value="dwc-1">DWC System 1</option>
        <option value="germination">Germination Chamber</option>
      </select>
    </div>
  );
};

// Data Collection - Multiple data points
const DataCollectionStep = ({ step, onUpdate }) => {
  const [data, setData] = useState(step.data.values || {});
  
  return (
    <div className="step-item data-collection">
      <h4>{step.data.text}</h4>
      <div className="data-fields">
        <div className="field">
          <label>pH:</label>
          <input
            type="number"
            step="0.1"
            value={data.ph || ''}
            onChange={(e) => {
              const newData = {...data, ph: e.target.value};
              setData(newData);
              onUpdate(step.id, { values: newData });
            }}
          />
        </div>
        <div className="field">
          <label>EC:</label>
          <input
            type="number"
            step="0.1"
            value={data.ec || ''}
            onChange={(e) => {
              const newData = {...data, ec: e.target.value};
              setData(newData);
              onUpdate(step.id, { values: newData });
            }}
          />
        </div>
        <div className="field">
          <label>Temp (Â°F):</label>
          <input
            type="number"
            value={data.temp || ''}
            onChange={(e) => {
              const newData = {...data, temp: e.target.value};
              setData(newData);
              onUpdate(step.id, { values: newData });
            }}
          />
        </div>
      </div>
    </div>
  );
};

// Photo Upload
const PhotoUploadStep = ({ step, onUpdate }) => {
  const [photo, setPhoto] = useState(step.data.photo || null);
  
  return (
    <div className="step-item photo-upload">
      <span className="step-label">{step.data.text}</span>
      <input
        type="file"
        accept="image/*"
        onChange={(e) => {
          const file = e.target.files[0];
          if (file) {
            // Handle file upload
            setPhoto(URL.createObjectURL(file));
            onUpdate(step.id, { photo: file });
          }
        }}
      />
      {photo && <img src={photo} alt="Upload" className="preview" />}
    </div>
  );
};

// Tray Split for Leafy Greens
const TraySplitStep = ({ step, onUpdate }) => {
  const [splits, setSplits] = useState(step.data.splits || []);
  
  return (
    <div className="step-item tray-split">
      <h4>{step.data.text}</h4>
      <div className="split-controls">
        <button onClick={() => {
          const newSplits = [...splits, { trayId: '', quantity: 0 }];
          setSplits(newSplits);
          onUpdate(step.id, { splits: newSplits });
        }}>
          Add Split
        </button>
      </div>
      {splits.map((split, index) => (
        <div key={index} className="split-entry">
          <input
            type="text"
            placeholder="Tray ID"
            value={split.trayId}
            onChange={(e) => {
              const newSplits = [...splits];
              newSplits[index].trayId = e.target.value;
              setSplits(newSplits);
              onUpdate(step.id, { splits: newSplits });
            }}
          />
          <input
            type="number"
            placeholder="Quantity"
            value={split.quantity}
            onChange={(e) => {
              const newSplits = [...splits];
              newSplits[index].quantity = e.target.value;
              setSplits(newSplits);
              onUpdate(step.id, { splits: newSplits });
            }}
          />
        </div>
      ))}
    </div>
  );
};

// Movement Trigger
const MovementTriggerStep = ({ step, onUpdate }) => {
  return (
    <div className="step-item movement-trigger">
      <button 
        className="trigger-button"
        onClick={() => onUpdate(step.id, { triggered: true, timestamp: new Date() })}
      >
        {step.data.text}
      </button>
      {step.data.triggered && (
        <span className="triggered-time">
          Triggered at {new Date(step.data.timestamp).toLocaleTimeString()}
        </span>
      )}
    </div>
  );
};
```

## Step 3: Create Master Step Renderer
Create a component that renders the correct step type:

```javascript
const ChecklistStepRenderer = ({ step, onUpdate }) => {
  switch (step.type) {
    case 'text_instruction':
      return <TextInstructionStep step={step} onUpdate={onUpdate} />;
    
    case 'simple_checkbox':
      return <SimpleCheckboxStep step={step} onUpdate={onUpdate} />;
    
    case 'number_input':
      return <NumberInputStep step={step} onUpdate={onUpdate} />;
    
    case 'inventory_selection':
      return <InventorySelectionStep step={step} onUpdate={onUpdate} />;
    
    case 'system_assignment':
      return <SystemAssignmentStep step={step} onUpdate={onUpdate} />;
    
    case 'data_collection':
      return <DataCollectionStep step={step} onUpdate={onUpdate} />;
    
    case 'photo_upload':
      return <PhotoUploadStep step={step} onUpdate={onUpdate} />;
    
    case 'tray_split':
      return <TraySplitStep step={step} onUpdate={onUpdate} />;
    
    case 'movement_trigger':
      return <MovementTriggerStep step={step} onUpdate={onUpdate} />;
    
    default:
      return <SimpleCheckboxStep step={step} onUpdate={onUpdate} />;
  }
};
```

## Step 4: Update Task Display
In the task detail view, use the renderer:

```javascript
const TaskDetail = ({ task }) => {
  const [checklistItems, setChecklistItems] = useState(task.checklist || []);
  
  const handleStepUpdate = (stepId, updates) => {
    setChecklistItems(items =>
      items.map(item =>
        item.id === stepId
          ? { ...item, data: { ...item.data, ...updates } }
          : item
      )
    );
  };
  
  return (
    <div className="task-detail">
      <h2>{task.name}</h2>
      
      <div className="checklist-container">
        {checklistItems.map(step => (
          <ChecklistStepRenderer
            key={step.id}
            step={step}
            onUpdate={handleStepUpdate}
          />
        ))}
      </div>
      
      <div className="time-info">
        {/* Time tracking info */}
      </div>
    </div>
  );
};
```

## Step 5: Add Styling
```css
.step-item {
  padding: 10px;
  margin: 10px 0;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.text-instruction {
  background: #f0f0f0;
  border-left: 4px solid #2196F3;
}

.number-input input {
  width: 100px;
  margin-left: 10px;
}

.data-collection .data-fields {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 10px;
}

.photo-upload .preview {
  max-width: 200px;
  margin-top: 10px;
}

.movement-trigger .trigger-button {
  background: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
```

## Testing:
1. Create a recurring task
2. Add different step types with "TEST" text
3. Each should render differently:
   - Text Instruction: Just shows text
   - Simple Checkbox: Shows checkbox
   - Number Input: Shows number field
   - Inventory Selection: Shows dropdown
   - System Assignment: Shows system dropdown
   - Data Collection: Shows pH/EC/Temp fields
   - Photo Upload: Shows file input
   - Movement Trigger: Shows button