# üîÑ Recurring Tasks Enhancement - Phase 5: Equipment Management Tab

## Phase 5: Create Equipment Management Tab inside Production Data page

### 1. UPDATE PRODUCTION DATA PAGE TO INCLUDE EQUIPMENT TAB:

Update `src/pages/ProductionData.tsx`:

```typescript
import React, { useState } from 'react';
import { CropConfiguration } from '../components/CropConfiguration';
import { ProductionDashboard } from '../components/ProductionDashboard';
import { EquipmentManagement } from '../components/EquipmentManagement';

export const ProductionData: React.FC = () => {
  const currentUser = getCurrentUser();
  const isCorporateManager = currentUser.role === 'Corporate';
  const isManager = currentUser.role === 'Manager' || isCorporateManager;
  
  const [activeTab, setActiveTab] = useState<'dashboard' | 'crops' | 'equipment'>('dashboard');
  
  if (!isManager) {
    return (
      <div className="access-denied">
        <h2>Access Restricted</h2>
        <p>Production Data is only available to managers.</p>
      </div>
    );
  }
  
  return (
    <div className="production-data-page">
      <div className="page-header">
        <h1>üå± Production Data</h1>
        <div className="tab-navigation">
          <button
            className={`tab-btn ${activeTab === 'dashboard' ? 'active' : ''}`}
            onClick={() => setActiveTab('dashboard')}
          >
            üìä Live Dashboard
          </button>
          {isCorporateManager && (
            <button
              className={`tab-btn ${activeTab === 'crops' ? 'active' : ''}`}
              onClick={() => setActiveTab('crops')}
            >
              üåæ Crop Configuration
            </button>
          )}
          <button
            className={`tab-btn ${activeTab === 'equipment' ? 'active' : ''}`}
            onClick={() => setActiveTab('equipment')}
          >
            üè≠ Equipment Management
          </button>
        </div>
      </div>
      
      {activeTab === 'dashboard' && <ProductionDashboard />}
      {activeTab === 'crops' && isCorporateManager && <CropConfiguration />}
      {activeTab === 'equipment' && <EquipmentManagement />}
    </div>
  );
};
```

### 2. CREATE EQUIPMENT MANAGEMENT COMPONENT:

Create `src/components/EquipmentManagement.tsx`:

```typescript
import React, { useState, useEffect } from 'react';
import { GrowingSystem } from '../data/systemsData';
import { Tray } from '../data/trayTracking';
import { SystemCapacityChart } from './SystemCapacityChart';
import { MovementHistory } from './MovementHistory';
import { SystemConfigurationModal } from './SystemConfigurationModal';

export const EquipmentManagement: React.FC = () => {
  const [systems, setSystems] = useState<GrowingSystem[]>([]);
  const [activeTrays, setActiveTrays] = useState<Tray[]>([]);
  const [selectedSystem, setSelectedSystem] = useState<string | null>(null);
  const [showConfigModal, setShowConfigModal] = useState(false);
  const [editingSystem, setEditingSystem] = useState<GrowingSystem | null>(null);
  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');
  
  const currentUser = getCurrentUser();
  const isCorporateManager = currentUser.role === 'Corporate';
  
  // Group systems by category
  const systemsByCategory = {
    microgreens: systems.filter(s => s.category === 'microgreens'),
    leafyGreens: systems.filter(s => s.category === 'leafyGreens')
  };
  
  // Calculate overall statistics
  const stats = {
    totalCapacity: systems.reduce((sum, s) => sum + s.configuration.totalCapacity, 0),
    totalOccupied: systems.reduce((sum, s) => sum + s.currentOccupancy, 0),
    utilizationRate: 0,
    systemsAtCapacity: systems.filter(s => s.currentOccupancy >= s.configuration.totalCapacity).length
  };
  stats.utilizationRate = stats.totalCapacity > 0 
    ? Math.round((stats.totalOccupied / stats.totalCapacity) * 100) 
    : 0;
  
  return (
    <div className="equipment-management">
      {/* Overview Stats */}
      <div className="equipment-stats">
        <div className="stat-card">
          <div className="stat-value">{stats.totalCapacity}</div>
          <div className="stat-label">Total Capacity</div>
        </div>
        <div className="stat-card">
          <div className="stat-value">{stats.totalOccupied}</div>
          <div className="stat-label">Currently Occupied</div>
        </div>
        <div className="stat-card">
          <div className="stat-value">{stats.utilizationRate}%</div>
          <div className="stat-label">Utilization Rate</div>
        </div>
        <div className="stat-card warning">
          <div className="stat-value">{stats.systemsAtCapacity}</div>
          <div className="stat-label">Systems at Capacity</div>
        </div>
      </div>
      
      {/* Controls */}
      <div className="equipment-controls">
        <div className="view-toggle">
          <button
            className={viewMode === 'grid' ? 'active' : ''}
            onClick={() => setViewMode('grid')}
          >
            <GridIcon /> Grid View
          </button>
          <button
            className={viewMode === 'list' ? 'active' : ''}
            onClick={() => setViewMode('list')}
          >
            <ListIcon /> List View
          </button>
        </div>
        
        {isCorporateManager && (
          <button
            className="btn-add-system"
            onClick={() => setShowConfigModal(true)}
          >
            + Add System
          </button>
        )}
      </div>
      
      {/* Systems Display */}
      <div className={`systems-display ${viewMode}`}>
        {/* Microgreens Section */}
        <div className="system-category">
          <h2>üå± Microgreen Systems</h2>
          <div className={`systems-${viewMode}`}>
            {systemsByCategory.microgreens.map(system => (
              <SystemCard
                key={system.id}
                system={system}
                viewMode={viewMode}
                onSelect={() => setSelectedSystem(system.id)}
                onEdit={isCorporateManager ? () => {
                  setEditingSystem(system);
                  setShowConfigModal(true);
                } : undefined}
              />
            ))}
          </div>
        </div>
        
        {/* Leafy Greens Section */}
        <div className="system-category">
          <h2>ü•¨ Leafy Green Systems</h2>
          <div className={`systems-${viewMode}`}>
            {systemsByCategory.leafyGreens.map(system => (
              <SystemCard
                key={system.id}
                system={system}
                viewMode={viewMode}
                onSelect={() => setSelectedSystem(system.id)}
                onEdit={isCorporateManager ? () => {
                  setEditingSystem(system);
                  setShowConfigModal(true);
                } : undefined}
              />
            ))}
          </div>
        </div>
      </div>
      
      {/* System Details Panel */}
      {selectedSystem && (
        <SystemDetailsPanel
          systemId={selectedSystem}
          systems={systems}
          trays={activeTrays}
          onClose={() => setSelectedSystem(null)}
        />
      )}
      
      {/* Configuration Modal */}
      {showConfigModal && (
        <SystemConfigurationModal
          system={editingSystem}
          onSave={(systemData) => {
            if (editingSystem) {
              setSystems(systems.map(s => 
                s.id === editingSystem.id ? { ...s, ...systemData } : s
              ));
            } else {
              setSystems([...systems, { ...systemData, id: generateSystemId() }]);
            }
            setShowConfigModal(false);
            setEditingSystem(null);
          }}
          onClose={() => {
            setShowConfigModal(false);
            setEditingSystem(null);
          }}
        />
      )}
    </div>
  );
};

// System Card Component
const SystemCard: React.FC<{
  system: GrowingSystem;
  viewMode: 'grid' | 'list';
  onSelect: () => void;
  onEdit?: () => void;
}> = ({ system, viewMode, onSelect, onEdit }) => {
  const occupancyPercent = Math.round(
    (system.currentOccupancy / system.configuration.totalCapacity) * 100
  );
  
  const getStatusColor = () => {
    if (occupancyPercent >= 90) return 'red';
    if (occupancyPercent >= 70) return 'yellow';
    return 'green';
  };
  
  if (viewMode === 'grid') {
    return (
      <div className={`system-card grid ${getStatusColor()}`} onClick={onSelect}>
        <div className="system-card-header">
          <h3>{system.name}</h3>
          {onEdit && (
            <button className="btn-edit" onClick={(e) => {
              e.stopPropagation();
              onEdit();
            }}>
              ‚úèÔ∏è
            </button>
          )}
        </div>
        
        <div className="system-visual">
          <SystemVisualizer system={system} />
        </div>
        
        <div className="system-stats">
          <div className="occupancy">
            <span className="occupied">{system.currentOccupancy}</span>
            <span className="separator">/</span>
            <span className="capacity">{system.configuration.totalCapacity}</span>
          </div>
          <div className="occupancy-bar">
            <div 
              className={`occupancy-fill ${getStatusColor()}`}
              style={{ width: `${occupancyPercent}%` }}
            />
          </div>
          <div className="occupancy-percent">{occupancyPercent}% Full</div>
        </div>
      </div>
    );
  }
  
  // List view
  return (
    <div className={`system-card list ${getStatusColor()}`} onClick={onSelect}>
      <div className="system-info">
        <h3>{system.name}</h3>
        <span className="system-type">{system.type}</span>
      </div>
      
      <div className="system-capacity">
        <span>{system.currentOccupancy} / {system.configuration.totalCapacity}</span>
        <div className="mini-bar">
          <div 
            className={`fill ${getStatusColor()}`}
            style={{ width: `${occupancyPercent}%` }}
          />
        </div>
      </div>
      
      <div className="system-sections">
        {system.configuration.sections?.map(section => (
          <span key={section.id} className="section-badge">
            {section.id}: {section.spots}
          </span>
        ))}
      </div>
      
      {onEdit && (
        <button className="btn-edit" onClick={(e) => {
          e.stopPropagation();
          onEdit();
        }}>
          Edit
        </button>
      )}
    </div>
  );
};
```

### 3. CREATE SYSTEM VISUALIZER COMPONENT:

Create `src/components/SystemVisualizer.tsx`:

```typescript
import React from 'react';
import { GrowingSystem } from '../data/systemsData';

export const SystemVisualizer: React.FC<{ system: GrowingSystem }> = ({ system }) => {
  if (system.type === 'nursery' || system.type === 'blackout') {
    // Simple staging area visualization
    return (
      <div className="system-viz staging">
        <div className="staging-area">
          {Array(Math.min(system.currentOccupancy, 20)).fill(0).map((_, i) => (
            <div key={i} className="tray-icon occupied" />
          ))}
          {system.currentOccupancy > 20 && (
            <div className="overflow-indicator">+{system.currentOccupancy - 20}</div>
          )}
        </div>
      </div>
    );
  }
  
  if (system.type === 'ebbFlow') {
    // Ebb & Flow visualization
    return (
      <div className="system-viz ebb-flow">
        {system.configuration.sections?.map(section => (
          <div key={section.id} className="ebb-section">
            <div className="section-label">{section.id}</div>
            <div className="section-spots">
              {Array(section.spots).fill(0).map((_, i) => {
                const spot = system.spots[i];
                return (
                  <div 
                    key={i} 
                    className={`spot ${spot?.occupied ? 'occupied' : 'empty'}`}
                  />
                );
              })}
            </div>
          </div>
        ))}
      </div>
    );
  }
  
  if (system.type === 'towers') {
    // Tower visualization
    const isHD = system.configuration.totalCapacity > 100;
    return (
      <div className={`system-viz tower ${isHD ? 'hd' : 'regular'}`}>
        <div className="tower-structure">
          <div className="tower-top" />
          <div className="tower-body">
            {Array(isHD ? 8 : 4).fill(0).map((_, i) => (
              <div key={i} className="tower-level">
                {Array(isHD ? 22 : 11).fill(0).map((_, j) => (
                  <div key={j} className="port" />
                ))}
              </div>
            ))}
          </div>
          <div className="tower-base" />
        </div>
      </div>
    );
  }
  
  if (system.type === 'nft') {
    // NFT channel visualization
    return (
      <div className="system-viz nft">
        {system.configuration.sections?.map((section, idx) => (
          <div key={section.id} className="nft-channel">
            <div className="channel-label">{section.id}</div>
            <div className="channel-slots">
              {Array(6).fill(0).map((_, i) => (
                <div key={i} className="slot-group">
                  {Array(3).fill(0).map((_, j) => {
                    const slotIndex = idx * 18 + i * 3 + j;
                    const occupied = system.spots[slotIndex]?.occupied;
                    return <div key={j} className={`slot ${occupied ? 'occupied' : ''}`} />;
                  })}
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
    );
  }
  
  return <div className="system-viz unknown">?</div>;
};
```

### 4. CREATE SYSTEM DETAILS PANEL:

Create `src/components/SystemDetailsPanel.tsx`:

```typescript
import React, { useState } from 'react';
import { GrowingSystem } from '../data/systemsData';
import { Tray } from '../data/trayTracking';

export const SystemDetailsPanel: React.FC<{
  systemId: string;
  systems: GrowingSystem[];
  trays: Tray[];
  onClose: () => void;
}> = ({ systemId, systems, trays, onClose }) => {
  const [activeTab, setActiveTab] = useState<'overview' | 'trays' | 'history'>('overview');
  const system = systems.find(s => s.id === systemId);
  
  if (!system) return null;
  
  const systemTrays = trays.filter(t => 
    t.currentLocation.systemId === systemId
  );
  
  return (
    <div className="system-details-panel">
      <div className="panel-header">
        <h2>{system.name} Details</h2>
        <button className="btn-close" onClick={onClose}>‚úï</button>
      </div>
      
      <div className="panel-tabs">
        <button
          className={activeTab === 'overview' ? 'active' : ''}
          onClick={() => setActiveTab('overview')}
        >
          Overview
        </button>
        <button
          className={activeTab === 'trays' ? 'active' : ''}
          onClick={() => setActiveTab('trays')}
        >
          Current Trays ({systemTrays.length})
        </button>
        <button
          className={activeTab === 'history' ? 'active' : ''}
          onClick={() => setActiveTab('history')}
        >
          Movement History
        </button>
      </div>
      
      <div className="panel-content">
        {activeTab === 'overview' && (
          <SystemOverview system={system} trays={systemTrays} />
        )}
        
        {activeTab === 'trays' && (
          <SystemTrays trays={systemTrays} />
        )}
        
        {activeTab === 'history' && (
          <MovementHistory systemId={systemId} />
        )}
      </div>
    </div>
  );
};

const SystemOverview: React.FC<{
  system: GrowingSystem;
  trays: Tray[];
}> = ({ system, trays }) => {
  // Group trays by crop type
  const traysByCrop = trays.reduce((acc, tray) => {
    if (!acc[tray.cropType]) acc[tray.cropType] = [];
    acc[tray.cropType].push(tray);
    return acc;
  }, {} as Record<string, Tray[]>);
  
  return (
    <div className="system-overview">
      <div className="overview-section">
        <h3>Configuration</h3>
        <div className="config-details">
          <div className="detail-row">
            <span>Type:</span>
            <span>{system.type}</span>
          </div>
          <div className="detail-row">
            <span>Category:</span>
            <span>{system.category}</span>
          </div>
          <div className="detail-row">
            <span>Total Capacity:</span>
            <span>{system.configuration.totalCapacity} spots</span>
          </div>
          {system.configuration.sections && (
            <div className="detail-row">
              <span>Sections:</span>
              <span>{system.configuration.sections.map(s => s.id).join(', ')}</span>
            </div>
          )}
        </div>
      </div>
      
      <div className="overview-section">
        <h3>Current Crops</h3>
        <div className="crop-breakdown">
          {Object.entries(traysByCrop).map(([crop, cropTrays]) => (
            <div key={crop} className="crop-row">
              <span className="crop-name">{crop}</span>
              <span className="crop-count">{cropTrays.length} trays</span>
              <span className="crop-spots">
                {cropTrays.reduce((sum, t) => sum + t.currentLocation.spotIds.length, 0)} spots
              </span>
            </div>
          ))}
        </div>
      </div>
      
      <div className="overview-section">
        <h3>Capacity Visualization</h3>
        <SystemCapacityChart system={system} />
      </div>
    </div>
  );
};

const SystemTrays: React.FC<{ trays: Tray[] }> = ({ trays }) => {
  const [sortBy, setSortBy] = useState<'date' | 'crop' | 'harvest'>('date');
  
  const sortedTrays = [...trays].sort((a, b) => {
    switch (sortBy) {
      case 'date':
        return b.datePlanted.getTime() - a.datePlanted.getTime();
      case 'crop':
        return a.cropType.localeCompare(b.cropType);
      case 'harvest':
        return a.expectedHarvest.getTime() - b.expectedHarvest.getTime();
      default:
        return 0;
    }
  });
  
  return (
    <div className="system-trays">
      <div className="trays-controls">
        <label>
          Sort by:
          <select value={sortBy} onChange={(e) => setSortBy(e.target.value as any)}>
            <option value="date">Plant Date</option>
            <option value="crop">Crop Type</option>
            <option value="harvest">Harvest Date</option>
          </select>
        </label>
      </div>
      
      <div className="trays-list">
        {sortedTrays.map(tray => (
          <div key={tray.id} className="tray-row">
            <div className="tray-id">{tray.id}</div>
            <div className="tray-crop">{tray.cropType}</div>
            <div className="tray-dates">
              <span>Planted: {new Date(tray.datePlanted).toLocaleDateString()}</span>
              <span>Harvest: {new Date(tray.expectedHarvest).toLocaleDateString()}</span>
            </div>
            <div className="tray-status">
              <span className={`status ${tray.status}`}>{tray.status}</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};
```

### 5. CREATE SYSTEM CONFIGURATION MODAL:

Create `src/components/SystemConfigurationModal.tsx`:

```typescript
import React, { useState } from 'react';
import { GrowingSystem } from '../data/systemsData';

export const SystemConfigurationModal: React.FC<{
  system?: GrowingSystem | null;
  onSave: (system: Partial<GrowingSystem>) => void;
  onClose: () => void;
}> = ({ system, onSave, onClose }) => {
  const [formData, setFormData] = useState({
    name: system?.name || '',
    type: system?.type || 'towers',
    category: system?.category || 'leafyGreens',
    location: system?.location || getCurrentLocation(),
    configuration: system?.configuration || {
      totalCapacity: 0,
      sections: []
    }
  });
  
  const [sections, setSections] = useState(
    system?.configuration.sections || [{ id: 'A', spots: 0, spotType: 'ports' }]
  );
  
  const systemTypes = {
    microgreens: ['nursery', 'blackout', 'microgreens'],
    leafyGreens: ['ebbFlow', 'towers', 'nft']
  };
  
  const handleAddSection = () => {
    const nextId = String.fromCharCode(65 + sections.length); // A, B, C...
    setSections([...sections, { id: nextId, spots: 0, spotType: 'ports' }]);
  };
  
  const handleRemoveSection = (index: number) => {
    setSections(sections.filter((_, i) => i !== index));
  };
  
  const handleSave = () => {
    const totalCapacity = sections.reduce((sum, s) => sum + s.spots, 0);
    
    onSave({
      ...formData,
      configuration: {
        ...formData.configuration,
        sections,
        totalCapacity,
        restrictions: formData.type === 'nft' ? { samePerChannel: true } : undefined
      }
    });
  };
  
  return (
    <div className="modal-overlay">
      <div className="modal-content system-config-modal">
        <div className="modal-header">
          <h2>{system ? 'Edit System' : 'Add New System'}</h2>
          <button className="btn-close" onClick={onClose}>‚úï</button>
        </div>
        
        <div className="modal-body">
          <div className="form-group">
            <label>
              System Name:
              <input
                type="text"
                value={formData.name}
                onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                placeholder="e.g., Tower A1"
              />
            </label>
          </div>
          
          <div className="form-group">
            <label>
              Category:
              <select
                value={formData.category}
                onChange={(e) => setFormData({ 
                  ...formData, 
                  category: e.target.value as any,
                  type: systemTypes[e.target.value][0]
                })}
              >
                <option value="microgreens">Microgreens</option>
                <option value="leafyGreens">Leafy Greens</option>
              </select>
            </label>
          </div>
          
          <div className="form-group">
            <label>
              System Type:
              <select
                value={formData.type}
                onChange={(e) => setFormData({ ...formData, type: e.target.value as any })}
              >
                {systemTypes[formData.category].map(type => (
                  <option key={type} value={type}>
                    {type.charAt(0).toUpperCase() + type.slice(1)}
                  </option>
                ))}
              </select>
            </label>
          </div>
          
          {/* Sections Configuration */}
          {(formData.type === 'ebbFlow' || formData.type === 'towers' || formData.type === 'nft') && (
            <div className="sections-config">
              <h3>Sections Configuration</h3>
              
              {sections.map((section, index) => (
                <div key={index} className="section-row">
                  <input
                    type="text"
                    value={section.id}
                    onChange={(e) => {
                      const updated = [...sections];
                      updated[index].id = e.target.value;
                      setSections(updated);
                    }}
                    placeholder="Section ID"
                    style={{ width: '100px' }}
                  />
                  
                  <input
                    type="number"
                    value={section.spots}
                    onChange={(e) => {
                      const updated = [...sections];
                      updated[index].spots = parseInt(e.target.value) || 0;
                      setSections(updated);
                    }}
                    placeholder="Capacity"
                    min="0"
                  />
                  
                  <select
                    value={section.spotType}
                    onChange={(e) => {
                      const updated = [...sections];
                      updated[index].spotType = e.target.value;
                      setSections(updated);
                    }}
                  >
                    <option value="ports">Ports</option>
                    <option value="slots">Slots</option>
                    <option value="spaces">Spaces</option>
                  </select>
                  
                  {sections.length > 1 && (
                    <button
                      className="btn-remove"
                      onClick={() => handleRemoveSection(index)}
                    >
                      Remove
                    </button>
                  )}
                </div>
              ))}
              
              <button className="btn-add-section" onClick={handleAddSection}>
                + Add Section
              </button>
            </div>
          )}
          
          {/* Simple capacity for staging areas */}
          {(formData.type === 'nursery' || formData.type === 'blackout') && (
            <div className="form-group">
              <label>
                Capacity:
                <input
                  type="number"
                  value={formData.configuration.totalCapacity}
                  onChange={(e) => setFormData({
                    ...formData,
                    configuration: {
                      ...formData.configuration,
                      totalCapacity: parseInt(e.target.value) || 0
                    }
                  })}
                  min="0"
                />
              </label>
            </div>
          )}
          
          {/* Special restrictions */}
          {formData.type === 'nft' && (
            <div className="form-note">
              ‚ÑπÔ∏è NFT channels require all plants in a channel to be the same type
            </div>
          )}
        </div>
        
        <div className="modal-footer">
          <button className="btn-cancel" onClick={onClose}>
            Cancel
          </button>
          <button 
            className="btn-save"
            onClick={handleSave}
            disabled={!formData.name || (sections.length > 0 && sections.some(s => !s.spots))}
          >
            {system ? 'Update System' : 'Create System'}
          </button>
        </div>
      </div>
    </div>
  );
};
```

### 6. ADD CSS STYLES:

```css
/* Equipment Management Styles */
.equipment-management {
  padding: 24px;
}

.equipment-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.stat-card {
  background: white;
  padding: 20px;
  border-radius: 8px;
  text-align: center;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.stat-card.warning {
  background: #fef3c7;
  border: 1px solid #fbbf24;
}

.stat-value {
  font-size: 32px;
  font-weight: 700;
  color: #1f2937;
  margin-bottom: 4px;
}

.stat-label {
  font-size: 14px;
  color: #6b7280;
}

.equipment-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.view-toggle {
  display: flex;
  gap: 8px;
  background: #f3f4f6;
  padding: 4px;
  border-radius: 6px;
}

.view-toggle button {
  padding: 8px 16px;
  border: none;
  background: transparent;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
}

.view-toggle button.active {
  background: white;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.btn-add-system {
  padding: 10px 20px;
  background: #2D8028;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
}

/* System Display */
.systems-display {
  display: flex;
  flex-direction: column;
  gap: 32px;
}

.system-category h2 {
  margin: 0 0 16px 0;
  color: #1f2937;
}

.systems-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 16px;
}

.systems-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* System Card - Grid View */
.system-card.grid {
  background: white;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  padding: 16px;
  cursor: pointer;
  transition: all 0.2s;
}

.system-card.grid:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.system-card.grid.green {
  border-color: #10b981;
}

.system-card.grid.yellow {
  border-color: #f59e0b;
}

.system-card.grid.red {
  border-color: #ef4444;
}

.system-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.system-card-header h3 {
  margin: 0;
  font-size: 18px;
}

.btn-edit {
  background: #f3f4f6;
  border: none;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.system-visual {
  height: 120px;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* System Visualizations */
.system-viz {
  width: 100%;
  height: 100%;
}

.system-viz.staging {
  display: flex;
  align-items: center;
  justify-content: center;
}

.staging-area {
  display: grid;
  grid-template-columns: repeat(5, 20px);
  gap: 4px;
}

.tray-icon {
  width: 20px;
  height: 20px;
  border-radius: 2px;
  background: #e5e7eb;
}

.tray-icon.occupied {
  background: #10b981;
}

.overflow-indicator {
  grid-column: span 5;
  text-align: center;
  color: #6b7280;
  font-size: 12px;
  margin-top: 4px;
}

/* Ebb & Flow Visualization */
.system-viz.ebb-flow {
  display: flex;
  gap: 8px;
  justify-content: center;
}

.ebb-section {
  text-align: center;
}

.section-label {
  font-size: 12px;
  color: #6b7280;
  margin-bottom: 4px;
}

.section-spots {
  display: grid;
  grid-template-columns: repeat(4, 12px);
  gap: 2px;
}

.spot {
  width: 12px;
  height: 12px;
  border-radius: 2px;
  background: #e5e7eb;
}

.spot.occupied {
  background: #10b981;
}

/* Tower Visualization */
.system-viz.tower {
  display: flex;
  align-items: center;
  justify-content: center;
}

.tower-structure {
  width: 60px;
}

.tower-top {
  width: 100%;
  height: 10px;
  background: #9ca3af;
  border-radius: 4px 4px 0 0;
}

.tower-body {
  background: #f3f4f6;
  border: 2px solid #9ca3af;
  border-top: none;
  padding: 4px;
}

.tower-level {
  display: grid;
  grid-template-columns: repeat(11, 4px);
  gap: 1px;
  margin-bottom: 2px;
}

.tower-level:last-child {
  margin-bottom: 0;
}

.port {
  width: 4px;
  height: 4px;
  background: #d1d5db;
  border-radius: 50%;
}

.tower-base {
  width: 100%;
  height: 8px;
  background: #6b7280;
}

/* NFT Visualization */
.system-viz.nft {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.nft-channel {
  display: flex;
  align-items: center;
  gap: 4px;
}

.channel-label {
  font-size: 10px;
  color: #6b7280;
  width: 30px;
}

.channel-slots {
  display: flex;
  gap: 2px;
}

.slot-group {
  display: flex;
  gap: 1px;
}

.slot {
  width: 8px;
  height: 8px;
  background: #e5e7eb;
  border-radius: 1px;
}

.slot.occupied {
  background: #10b981;
}

/* System Stats */
.system-stats {
  text-align: center;
}

.occupancy {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 8px;
}

.occupancy .occupied {
  color: #059669;
}

.occupancy .separator {
  color: #9ca3af;
  margin: 0 4px;
}

.occupancy .capacity {
  color: #6b7280;
}

.occupancy-bar {
  height: 8px;
  background: #e5e7eb;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 4px;
}

.occupancy-fill {
  height: 100%;
  transition: width 0.3s;
}

.occupancy-fill.green {
  background: #10b981;
}

.occupancy-fill.yellow {
  background: #f59e0b;
}

.occupancy-fill.red {
  background: #ef4444;
}

.occupancy-percent {
  font-size: 12px;
  color: #6b7280;
}

/* System Card - List View */
.system-card.list {
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 16px;
  cursor: pointer;
}

.system-card.list:hover {
  background: #f9fafb;
}

.system-info {
  flex: 1;
}

.system-info h3 {
  margin: 0 0 4px 0;
  font-size: 16px;
}

.system-type {
  color: #6b7280;
  font-size: 14px;
}

.system-capacity {
  width: 150px;
  text-align: center;
}

.mini-bar {
  height: 4px;
  background: #e5e7eb;
  border-radius: 2px;
  margin-top: 4px;
  overflow: hidden;
}

.mini-bar .fill {
  height: 100%;
}

.system-sections {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
}

.section-badge {
  background: #f3f4f6;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 12px;
  color: #4b5563;
}

/* System Details Panel */
.system-details-panel {
  position: fixed;
  right: 0;
  top: 0;
  height: 100vh;
  width: 500px;
  background: white;
  box-shadow: -4px 0 6px rgba(0, 0, 0, 0.1);
  z-index: 100;
  display: flex;
  flex-direction: column;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #e5e7eb;
}

.panel-header h2 {
  margin: 0;
}

.btn-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #6b7280;
}

.panel-tabs {
  display: flex;
  border-bottom: 1px solid #e5e7eb;
}

.panel-tabs button {
  flex: 1;
  padding: 12px;
  border: none;
  background: none;
  cursor: pointer;
  position: relative;
  color: #6b7280;
}

.panel-tabs button.active {
  color: #2D8028;
}

.panel-tabs button.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: #2D8028;
}

.panel-content {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

/* System Overview */
.system-overview {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.overview-section h3 {
  margin: 0 0 12px 0;
  font-size: 16px;
  color: #1f2937;
}

.config-details {
  background: #f9fafb;
  padding: 16px;
  border-radius: 6px;
}

.detail-row {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
  font-size: 14px;
}

.detail-row span:first-child {
  color: #6b7280;
}

.detail-row span:last-child {
  color: #1f2937;
  font-weight: 500;
}

.crop-breakdown {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.crop-row {
  display: flex;
  align-items: center;
  padding: 8px;
  background: #f9fafb;
  border-radius: 4px;
}

.crop-name {
  flex: 1;
  font-weight: 500;
}

.crop-count,
.crop-spots {
  color: #6b7280;
  font-size: 14px;
  margin-left: 16px;
}

/* System Configuration Modal */
.system-config-modal {
  max-width: 600px;
}

.sections-config {
  margin-top: 20px;
  padding: 16px;
  background: #f9fafb;
  border-radius: 6px;
}

.sections-config h3 {
  margin: 0 0 12px 0;
  font-size: 16px;
}

.section-row {
  display: flex;
  gap: 8px;
  align-items: center;
  margin-bottom: 8px;
}

.section-row input,
.section-row select {
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 4px;
}

.btn-add-section {
  width: 100%;
  padding: 8px;
  background: #e5e7eb;
  border: 1px dashed #9ca3af;
  border-radius: 4px;
  cursor: pointer;
  margin-top: 8px;
}

.form-note {
  background: #eff6ff;
  color: #1e40af;
  padding: 12px;
  border-radius: 4px;
  font-size: 14px;
  margin-top: 12px;
}

/* Responsive */
@media (max-width: 768px) {
  .equipment-stats {
    grid-template-columns: 1fr 1fr;
  }
  
  .systems-grid {
    grid-template-columns: 1fr;
  }
  
  .system-details-panel {
    width: 100%;
  }
}
```

### SUMMARY:

Phase 5 implements the Equipment Management Tab with:

‚úÖ **System overview dashboard** - Visual capacity indicators and statistics
‚úÖ **Capacity tracking** - Real-time occupancy for all systems
‚úÖ **Movement history** - Complete audit trail of tray movements
‚úÖ **System configuration** - Corporate managers can add/edit systems
‚úÖ **Visual system representations** - Different visualizations for each system type
‚úÖ **Detailed system panels** - View current trays, history, and configuration

Key features:
- Grid and list view options for different preferences
- Visual representations of each system type (towers, NFT channels, etc.)
- Color-coded capacity indicators (green/yellow/red)
- Editable system configurations with section management
- Real-time occupancy tracking with detailed breakdowns
- Movement history and tray tracking per system

The Equipment Management tab is now fully integrated into the Production Data page, providing comprehensive system monitoring and management capabilities!