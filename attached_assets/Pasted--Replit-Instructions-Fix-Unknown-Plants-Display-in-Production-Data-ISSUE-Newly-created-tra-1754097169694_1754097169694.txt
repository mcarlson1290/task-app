# Replit Instructions: Fix "Unknown" Plants Display in Production Data

**ISSUE: Newly created trays show "5 Unknown" instead of the actual crop varieties**

## Step 1: Update Create Tray Data Structure

When creating a tray, make sure to save the variety information:

```tsx
const handleCreateTray = () => {
  const trayData = {
    id: trayId,
    type: trayType,
    status: 'seeded',
    location: 'staging-B1',
    createdBy: currentUser,
    createdAt: new Date(),
    // ADD THIS: Store varieties with their names
    varieties: varieties.map(v => ({
      seedId: v.seedId,
      seedName: v.seedName,  // This is what's missing!
      quantity: v.quantity
    })),
    totalPlants: totalPlants,
    growingMedium: growingMedium,
    // ... other fields
  };
  
  saveTray(trayData);
};
```

## Step 2: Update Production Data Display

In the Production Data component, display variety names:

```tsx
// Instead of just showing count
<div>{tray.totalPlants} Unknown</div>

// Show variety breakdown
<div>
  {tray.varieties && tray.varieties.length > 0 ? (
    tray.varieties.map((variety, index) => (
      <div key={index}>
        {variety.quantity} {variety.seedName}
      </div>
    ))
  ) : (
    <div>{tray.totalPlants || 0} Unknown</div>
  )}
</div>
```

## Step 3: Handle Mixed Varieties

For trays with multiple varieties, show them properly:

```tsx
// For a tray with multiple varieties
const renderPlantInfo = (tray) => {
  if (!tray.varieties || tray.varieties.length === 0) {
    return `${tray.totalPlants || 0} Unknown`;
  }
  
  if (tray.varieties.length === 1) {
    // Single variety: "50 Romaine"
    return `${tray.varieties[0].quantity} ${tray.varieties[0].seedName}`;
  }
  
  // Multiple varieties: "Mixed: 30 Romaine, 20 Arugula"
  const varietyList = tray.varieties
    .map(v => `${v.quantity} ${v.seedName}`)
    .join(', ');
  return `Mixed: ${varietyList}`;
};
```

## Step 4: Fix Data Migration

For existing trays showing "Unknown", add a data check:

```tsx
// When loading tray data
const loadTrayData = (trayId) => {
  const tray = getTray(trayId);
  
  // If old format without varieties, try to extract from tray ID
  if (!tray.varieties && tray.id) {
    // Extract crop from ID like "K080125-LG-MIX-1"
    const parts = tray.id.split('-');
    const cropCode = parts[2]; // MIX, ROM, ARU, etc.
    
    // Map to full names
    const cropNames = {
      'MIX': 'Mixed',
      'ROM': 'Romaine',
      'ARU': 'Arugula',
      'BAS': 'Basil',
      // ... add more mappings
    };
    
    tray.displayName = `${tray.totalPlants} ${cropNames[cropCode] || 'Unknown'}`;
  }
  
  return tray;
};
```

## Step 5: Update Card Display

Make sure the production cards show variety info:

```tsx
<div className="production-card">
  <h4>{tray.id}</h4>
  <div className="plant-info">
    <span className="icon">ðŸŒ±</span>
    {/* Show actual varieties instead of Unknown */}
    <span>{renderPlantInfo(tray)}</span>
  </div>
  <div>Location: {tray.location}</div>
  {/* ... rest of card */}
</div>
```

The core issue is that the variety names aren't being saved with the tray data when created, so the display has no information about what crops were planted!