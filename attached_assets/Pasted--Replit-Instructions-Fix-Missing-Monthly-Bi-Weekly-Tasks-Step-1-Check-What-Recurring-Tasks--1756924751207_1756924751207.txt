# Replit Instructions: Fix Missing Monthly/Bi-Weekly Tasks

## Step 1: Check What Recurring Tasks Exist

Add this debug button to see ALL recurring task templates:

```javascript
// Add this button to your UI temporarily
<button 
  onClick={() => {
    console.log('=== RECURRING TASK TEMPLATES ===');
    const recurring = getRecurringTasks(); // or however you get them
    console.table(recurring.map(r => ({
      title: r.title,
      frequency: r.frequency,
      id: r.id
    })));
  }}
  className="px-4 py-2 bg-purple-600 text-white rounded"
>
  Debug Recurring Tasks
</button>
```

## Step 2: Check if Task Instances Exist

Add this to see what task instances are in the database:

```javascript
// Add another debug button
<button 
  onClick={() => {
    const allTasks = getAllTasks(); // your method to get all tasks
    const recurring = allTasks.filter(t => t.recurringTaskId);
    
    console.log('=== TASK INSTANCES ===');
    console.log('Total tasks:', allTasks.length);
    console.log('Recurring task instances:', recurring.length);
    
    // Group by frequency
    const byFreq = {};
    recurring.forEach(t => {
      byFreq[t.frequency || 'none'] = (byFreq[t.frequency || 'none'] || 0) + 1;
    });
    console.log('Tasks by frequency:', byFreq);
    
    // Show some examples
    const monthly = recurring.filter(t => t.frequency === 'monthly');
    const biweekly = recurring.filter(t => t.frequency === 'biweekly');
    
    console.log('Monthly tasks:', monthly.slice(0, 3));
    console.log('Bi-weekly tasks:', biweekly.slice(0, 3));
  }}
  className="px-4 py-2 bg-blue-600 text-white rounded"
>
  Debug Task Instances
</button>
```

## Step 3: Force Generate Monthly/Bi-Weekly Tasks

Add this button to manually generate tasks for September:

```javascript
<button 
  onClick={async () => {
    console.log('Generating September tasks...');
    
    const recurringTasks = await getRecurringTasks();
    const september1 = new Date(2025, 8, 1); // September 1, 2025
    const september15 = new Date(2025, 8, 15); // September 15, 2025
    
    let generated = 0;
    
    for (const recurring of recurringTasks) {
      if (recurring.frequency === 'monthly') {
        const taskId = `${recurring.id}-2025-09-01`;
        const existing = await getTaskById(taskId);
        
        if (!existing) {
          const task = {
            id: taskId,
            title: recurring.title,
            frequency: 'monthly',
            recurringTaskId: recurring.id,
            visibleFromDate: '2025-09-01',
            dueDate: '2025-09-30',
            status: 'pending',
            type: recurring.type,
            priority: recurring.priority,
            assignedTo: recurring.assignedTo
          };
          
          await saveTask(task);
          console.log('Generated monthly:', task.title);
          generated++;
        }
      }
      
      if (recurring.frequency === 'biweekly') {
        // First half
        const taskId1 = `${recurring.id}-2025-09-01`;
        const existing1 = await getTaskById(taskId1);
        
        if (!existing1) {
          const task1 = {
            id: taskId1,
            title: recurring.title,
            frequency: 'biweekly',
            recurringTaskId: recurring.id,
            visibleFromDate: '2025-09-01',
            dueDate: '2025-09-14',
            status: 'pending',
            type: recurring.type,
            priority: recurring.priority,
            assignedTo: recurring.assignedTo
          };
          
          await saveTask(task1);
          console.log('Generated bi-weekly (1st):', task1.title);
          generated++;
        }
        
        // Second half  
        const taskId2 = `${recurring.id}-2025-09-15`;
        const existing2 = await getTaskById(taskId2);
        
        if (!existing2) {
          const task2 = {
            id: taskId2,
            title: recurring.title,
            frequency: 'biweekly',
            recurringTaskId: recurring.id,
            visibleFromDate: '2025-09-15',
            dueDate: '2025-09-30',
            status: 'pending',
            type: recurring.type,
            priority: recurring.priority,
            assignedTo: recurring.assignedTo
          };
          
          await saveTask(task2);
          console.log('Generated bi-weekly (15th):', task2.title);
          generated++;
        }
      }
    }
    
    alert(`Generated ${generated} tasks. Refresh to see them.`);
    window.location.reload();
  }}
  className="px-4 py-2 bg-green-600 text-white rounded"
>
  Generate Sept Monthly/Bi-Weekly
</button>
```

## Step 4: Fix the Date Filter

The issue might be the date filter. Update it to properly check date ranges:

```javascript
const filterTasksByDate = (tasks, selectedDate) => {
  const viewDate = new Date(selectedDate);
  viewDate.setHours(0, 0, 0, 0);
  
  return tasks.filter(task => {
    // For tasks with visibleFromDate (monthly, bi-weekly, quarterly)
    if (task.visibleFromDate) {
      const visibleFrom = new Date(task.visibleFromDate);
      const dueDate = new Date(task.dueDate);
      
      visibleFrom.setHours(0, 0, 0, 0);
      dueDate.setHours(0, 0, 0, 0);
      
      // Check if viewDate is between visibleFrom and dueDate (inclusive)
      const isVisible = viewDate >= visibleFrom && viewDate <= dueDate;
      
      if (task.frequency === 'monthly' || task.frequency === 'biweekly') {
        console.log(`Checking ${task.title}:`, {
          viewDate: viewDate.toDateString(),
          visibleFrom: visibleFrom.toDateString(),
          dueDate: dueDate.toDateString(),
          isVisible
        });
      }
      
      return isVisible;
    }
    
    // Regular tasks - exact date match
    const taskDate = new Date(task.dueDate || task.completionDate);
    taskDate.setHours(0, 0, 0, 0);
    
    return taskDate.getTime() === viewDate.getTime();
  });
};
```

## Step 5: Create Test Tasks

If no monthly/bi-weekly tasks exist at all, create some test ones:

```javascript
// Go to Recurring Tasks page and create:
// 1. A monthly task with frequency = "monthly"
// 2. A bi-weekly task with frequency = "biweekly"

// Or add this temporary code to create them:
const createTestRecurringTasks = async () => {
  const testTasks = [
    {
      id: 'test-monthly-1',
      title: 'Monthly Inventory Check',
      frequency: 'monthly',
      type: 'Other',
      priority: 'medium',
      assignedTo: 'role_General Staff'
    },
    {
      id: 'test-biweekly-1',
      title: 'Bi-Weekly Deep Clean',
      frequency: 'biweekly',
      type: 'Cleaning',
      priority: 'high',
      assignedTo: 'role_Cleaning Crew'
    }
  ];
  
  // Save these as recurring task templates
  for (const task of testTasks) {
    await saveRecurringTask(task);
  }
  
  console.log('Created test recurring tasks');
};
```

## What to Check

After adding these debug tools:

1. Click "Debug Recurring Tasks" - Do you see any monthly/bi-weekly templates?
2. Click "Debug Task Instances" - Are there any monthly/bi-weekly instances?
3. Click "Generate Sept Monthly/Bi-Weekly" - Does this create tasks?
4. Check the console when filtering - Are tasks being filtered out?

Let me know what the debug buttons show!